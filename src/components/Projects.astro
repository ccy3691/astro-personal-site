---
import '../styles/shared.css';
import ProjectCard from './ProjectCard.astro';
import surveyPlatform from '../assets/survey_platform.png';
import portfolioSite from '../assets/portfolio_site.png';

const projects = [
	{
		image: { src: surveyPlatform.src, alt: 'Autosolve Survey Platform' },
		title: 'Autosolve Survey Platform',
		description: 'Solo project to build full web application for client. Survey platform for creating, sending, and analyzing surveys results to aid in business operations',
		tags: ['React', 'Laravel', 'Postgres', 'Multitenant']
	},
	{
		image: { src: portfolioSite.src, alt: 'Portfolio Website' },
		title: 'Portfolio Website',
		description: 'Simple static site to showcase my experience and some of my projects',
		tags: ['Astro', 'Tailwind', 'Cloudflare Pages']
	}
];
---

<section id="projects" class="section projects-section">
	<div class="section-container">
		<h2 class="section-title">Projects</h2>
		<div class="projects-grid">
			<div class="project-card">
			    <img src={surveyPlatform.src} alt="Autosolve Survey Platform" class="project-image clickable-image" data-image={surveyPlatform.src} data-alt="Autosolve Survey Platform" />
				<h3>Autosolve Survey Platform</h3>
				<p>Solo project to build full web application for client. Survey platform for creating, sending, and analyzing surveys results to aid in business operations</p>
				<div class="project-tags">
					<span class="tag">React</span>
					<span class="tag">Laravel</span>
					<span class="tag">Postgres</span>
                    <span class="tag">Multitenant</span>
				</div>
			</div>
			<div class="project-card">
                    <img src={portfolioSite.src} alt="Portfolio Website" class="project-image clickable-image" data-image={portfolioSite.src} data-alt="Portfolio Website" />
				<h3>Portfolio Website</h3>
				<p>Simple static site to showcase my experience and some of my projects</p>
				<div class="project-tags">
					<span class="tag">Astro</span>
					<span class="tag">Tailwind</span>
					<span class="tag">Cloudflare Pages</span>
				</div>
			</div>
		</div>
	</div>

	<!-- Image Lightbox Modal -->
	<div id="imageLightbox" class="lightbox">
		<span class="lightbox-close">&times;</span>
		<img class="lightbox-content" id="lightboxImage" src="" alt="" />
	</div>
</section>

<script>
	// Intersection Observer for fade-in animations
	const observerOptions = {
		threshold: 0.1,
		rootMargin: '0px 0px -50px 0px'
	};

	const observer = new IntersectionObserver((entries) => {
		entries.forEach(entry => {
			if (entry.isIntersecting) {
				entry.target.style.opacity = '1';
			}
		});
	}, observerOptions);

	document.querySelectorAll('.project-card').forEach(el => {
		observer.observe(el);
	});

	// Lightbox functionality
	const lightbox = document.getElementById('imageLightbox');
	const lightboxImage = document.getElementById('lightboxImage');
	const closeBtn = document.querySelector('.lightbox-close');

	// Open lightbox on image click
	document.querySelectorAll('.clickable-image').forEach(img => {
		img.addEventListener('click', function() {
			lightbox.style.display = 'flex';
			lightboxImage.src = this.dataset.image;
			lightboxImage.alt = this.dataset.alt;
		});
	});

	// Close lightbox
	closeBtn?.addEventListener('click', () => {
		lightbox.style.display = 'none';
	});

	// Close lightbox when clicking outside the image
	lightbox?.addEventListener('click', (e) => {
		if (e.target === lightbox) {
			lightbox.style.display = 'none';
		}
	});

	// Close lightbox with Escape key
	document.addEventListener('keydown', (e) => {
		if (e.key === 'Escape') {
			lightbox.style.display = 'none';
		}
	});
</script>
